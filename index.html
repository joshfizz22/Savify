<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<!-- Google AdSense Verification -->
<meta name="google-adsense-account" content="ca-pub-6774980266966517">
<!-- LocalForage Storage Library -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/localforage/1.10.0/localforage.min.js"></script>

<!-- ======= YOUR APP ICON ======= -->
<link rel="icon" href="icon.png" type="image/png">
<link rel="apple-touch-icon" href="icon.png">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="default">
<meta name="theme-color" content="#25D366">
<meta name="mobile-web-app-capable" content="yes">

<!-- Web App Manifest -->
<link rel="manifest" href="data:application/manifest+json,{
  \"name\": \"Savify - WhatsApp Status Saver\",
  \"short_name\": \"Savify\",
  \"description\": \"Download and save WhatsApp status updates easily\",
  \"start_url\": \".\",
  \"display\": \"standalone\",
  \"theme_color\": \"#25D366\",
  \"background_color\": \"#ffffff\",
  \"orientation\": \"portrait\",
  \"icons\": [
    {
      \"src\": \"icon.png\",
      \"sizes\": \"192x192\",
      \"type\": \"image/png\"
    },
    {
      \"src\": \"icon.png\", 
      \"sizes\": \"512x512\",
      \"type\": \"image/png\"
    }
  ]
}">

<title>Savify - Download WhatsApp Status Videos & Images</title>
<meta name="description" content="Free WhatsApp Status Saver - Download and save status updates from WhatsApp and WhatsApp Business. Easy, fast, and 100% free.">

<style>
  :root {
    --bg-color: #f0f0f0;
    --text-color: #000;
    --topbar-bg: #25D366;
    --topbar-text: #fff;
    --tab-bg: #fff;
    --tab-text: #666;
    --active-tab: #25D366;
    --setting-bg: #fff;
    --toggle-bg: #ddd;
    --toggle-active: #25D366;
  }
  [data-theme="dark"] {
    --bg-color: #121212;
    --text-color: #fff;
    --topbar-bg: #075e54;
    --topbar-text: #fff;
    --tab-bg: #1e1e1e;
    --tab-text: #bbb;
    --active-tab: #25D366;
    --setting-bg: #1e1e1e;
    --toggle-bg: #444;
    --toggle-active: #25D366;
  }
  body {
    margin: 0;
    padding: 14px;
    font-family: Arial, sans-serif;
    background: var(--bg-color);
    color: var(--text-color);
    transition: all 0.3s;
    line-height: 1.6;
  }
  .topbar {
    display: flex;
    align-items: center;
    justify-content: space-between;
    background: var(--topbar-bg);
    color: var(--topbar-text);
    padding: 10px;
    border-radius: 10px 10px 0 0;
  }
  .bell {
    font-size: 24px;
    cursor: pointer;
  }
  .notification-popup {
    display: none;
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background: var(--setting-bg);
    padding: 20px;
    border-radius: 10px;
    box-shadow: 0 0 10px rgba(0,0,0,0.1);
    z-index: 1000;
    text-align: center;
    color: var(--text-color);
  }
  .tab-bar {
    display: flex;
    justify-content: space-around;
    background: var(--tab-bg);
    padding: 10px;
    border-bottom: 1px solid #eee;
  }
  .tab {
    display: flex;
    flex-direction: column;
    align-items: center;
    color: var(--tab-text);
    font-size: 12px;
    cursor: pointer;
  }
  .tab.active {
    color: var(--active-tab);
  }
  .tab-icon {
    width: 24px;
    height: 24px;
    margin-bottom: 4px;
    background: currentColor;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 12px;
  }
  .page {
    display: none;
    background: var(--setting-bg);
    padding: 20px;
    color: var(--text-color);
    min-height: 400px;
  }
  .page.active {
    display: block;
  }
  .splash {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: var(--bg-color);
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    z-index: 1000;
    opacity: 1;
    transition: opacity 0.5s ease;
  }
  .splash.hidden {
    opacity: 0;
    pointer-events: none;
  }
  .logo img {
    width: 100px;
    height: auto;
  }
  .name {
    font-size: 24px;
    font-weight: bold;
    color: var(--topbar-text);
    margin-top: 10px;
  }
  .content-section {
    margin-bottom: 30px;
  }
  .content-section h2 {
    color: var(--topbar-bg);
    margin-bottom: 15px;
  }
  .content-section p {
    margin-bottom: 15px;
    text-align: justify;
  }
  .feature-list {
    list-style: none;
    padding: 0;
  }
  .feature-list li {
    padding: 8px 0;
    border-bottom: 1px solid #eee;
  }
  .feature-list li:before {
    content: "✅ ";
    margin-right: 10px;
  }
  .step-by-step {
    background: var(--bg-color);
    padding: 20px;
    border-radius: 10px;
    margin: 20px 0;
  }
  .step {
    margin-bottom: 15px;
    padding-left: 20px;
    border-left: 3px solid var(--topbar-bg);
  }
  .btn {
    background: var(--topbar-bg);
    color: var(--topbar-text);
    border: none;
    padding: 12px 24px;
    border-radius: 25px;
    cursor: pointer;
    font-size: 16px;
    margin: 10px 5px;
  }
  .homepage-empty {
    text-align: center;
    padding: 40px;
  }
  .guide-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: var(--bg-color);
    z-index: 9999;
    display: none;
    justify-content: center;
    align-items: center;
    flex-direction: column;
    padding: 20px;
  }
  .guide-step {
    display: none;
    text-align: center;
  }
  .guide-step.active {
    display: block;
  }
  .guide-step img {
    width: 100%;
    max-width: 300px;
    margin-bottom: 20px;
  }
  .guide-step p {
    font-size: 16px;
    margin-bottom: 20px;
  }
  .guide-buttons {
    display: flex;
    gap: 10px;
  }
  .skip-btn {
    background: transparent;
    border: 1px solid var(--text-color);
    color: var(--text-color);
    padding: 10px 20px;
    border-radius: 25px;
    cursor: pointer;
  }
  .setting-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 15px 0;
    border-bottom: 1px solid #333;
  }
  .toggle {
    background: var(--toggle-bg);
    border-radius: 20px;
    width: 50px;
    height: 30px;
    position: relative;
    cursor: pointer;
  }
  .toggle.active {
    background: var(--toggle-active);
  }
  .toggle-knob {
    background: var(--topbar-text);
    border-radius: 50%;
    width: 26px;
    height: 26px;
    position: absolute;
    top: 2px;
    left: 2px;
    transition: transform 0.2s;
  }
  .toggle.active .toggle-knob {
    transform: translateX(20px);
  }
  .app-selector {
    display: flex;
    gap: 10px;
    margin: 15px 0;
  }
  .app-selector input[type="radio"] {
    display: none;
  }
  .app-selector label {
    padding: 12px 20px;
    background: #eee;
    border-radius: 8px;
    cursor: pointer;
    color: var(--text-color);
    flex: 1;
    text-align: center;
  }
  .app-selector input[type="radio"]:checked + label {
    background: var(--toggle-active);
    color: var(--topbar-text);
  }
  .vip-section {
    background: var(--setting-bg);
    padding: 20px;
    margin-bottom: 20px;
    border-radius: 10px;
    text-align: center;
    color: var(--text-color);
    cursor: pointer;
    border: 2px solid gold;
  }
  .vip-badge {
    background: gold;
    color: #000;
    padding: 8px 16px;
    border-radius: 20px;
    font-weight: bold;
    margin-bottom: 10px;
    display: inline-block;
  }
  .gallery {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
    gap: 10px;
    padding: 20px 0;
  }
  .gallery-item {
    position: relative;
    overflow: hidden;
    border-radius: 10px;
  }
  .gallery-item img {
    width: 100%;
    height: 100px;
    object-fit: cover;
    display: block;
  }
  .gallery-item .delete-btn {
    position: absolute;
    top: 5px;
    right: 5px;
    background: rgba(255, 0, 0, 0.7);
    color: white;
    border: none;
    border-radius: 50%;
    width: 25px;
    height: 25px;
    cursor: pointer;
    font-size: 16px;
  }
  #ad-container {
    padding: 10px;
    text-align: center;
    background: var(--setting-bg);
    border-top: 1px solid #eee;
    margin-top: 20px;
  }
  .modal-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0,0,0,0.8);
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 10000;
  }
  .modal-content {
    background: var(--setting-bg);
    padding: 20px;
    border-radius: 10px;
    max-width: 90%;
    max-height: 80%;
    overflow-y: auto;
    position: relative;
  }
  .close-modal {
    position: absolute;
    top: 10px;
    right: 10px;
    background: none;
    border: none;
    font-size: 24px;
    cursor: pointer;
    color: var(--text-color);
  }
  .loading {
    text-align: center;
    padding: 20px;
  }
  .content-nav {
    display: flex;
    gap: 10px;
    margin: 20px 0;
    flex-wrap: wrap;
  }
  .content-nav .btn {
    flex: 1;
    min-width: 120px;
  }
  .install-hint {
    background: var(--setting-bg);
    padding: 15px;
    margin: 15px 0;
    border-radius: 10px;
    text-align: center;
    border-left: 4px solid var(--topbar-bg);
  }
</style>
</head>
<body>
  <div class="splash" id="splash">
    <div class="logo">
      <!-- Your icon will show here -->
      <img src="icon.png" alt="Savify Logo" style="width: 100px; height: 100px; border-radius: 20px;">
    </div>
    <div class="name">Savify</div>
    <p style="color: var(--text-color); margin-top: 10px;">WhatsApp Status Saver</p>
  </div>

  <div class="guide-overlay" id="guideOverlay">
    <div class="guide-step active" id="step1">
      <h2>Welcome to Savify! 🎉</h2>
      <p>Savify helps you download and save WhatsApp status updates easily.</p>
      <div class="guide-buttons">
        <button class="skip-btn" onclick="skipGuide()">Skip Tutorial</button>
        <button class="btn" onclick="nextStep()">Get Started</button>
      </div>
    </div>
    <div class="guide-step" id="step2">
      <h3>Step 1: View WhatsApp Status</h3>
      <p>Open WhatsApp and watch the status updates you want to save.</p>
      <div class="guide-buttons">
        <button class="skip-btn" onclick="skipGuide()">Skip</button>
        <button class="btn" onclick="nextStep()">Next</button>
      </div>
    </div>
    <div class="guide-step" id="step3">
      <h3>Step 2: Select Status Files</h3>
      <p>Switch to Savify and tap "Select Statuses" to choose images and videos.</p>
      <div class="guide-buttons">
        <button class="skip-btn" onclick="skipGuide()">Skip</button>
        <button class="btn" onclick="nextStep()">Next</button>
      </div>
    </div>
    <div class="guide-step" id="step4">
      <h3>Step 3: Save to Gallery</h3>
      <p>Your selected statuses will be saved in the app's gallery.</p>
      <div class="guide-buttons">
        <button class="skip-btn" onclick="skipGuide()">Skip</button>
        <button class="btn" onclick="nextStep()">Next</button>
      </div>
    </div>
    <div class="guide-step" id="step5">
      <h3>Step 4: Enjoy Your Saved Statuses! 🎯</h3>
      <p>Access your saved statuses anytime, even when they disappear from WhatsApp.</p>
      <div class="guide-buttons">
        <button class="skip-btn" onclick="skipGuide()">Skip</button>
        <button class="btn" onclick="closeGuide()">Start Using Savify</button>
      </div>
    </div>
  </div>

  <div class="topbar">
    <h1>Savify</h1>
    <div class="bell" onclick="showNotification()">🔔</div>
  </div>

  <div class="notification-popup" id="notificationPopup">
    <span class="close" onclick="hideNotification()">×</span>
    <h3>New Status Available! 📱</h3>
    <p>Get notified when new WhatsApp statuses are available.</p>
    <button class="btn" onclick="hideNotification()">CONTINUE</button>
  </div>

  <div class="install-hint">
    <h3>📱 Install Savify as App</h3>
    <p><strong>For best experience, install on your home screen:</strong></p>
    <p>Android: Chrome menu → "Add to Home screen"</p>
    <p>iPhone: Safari share → "Add to Home Screen"</p>
    <p><em>Your Savify icon will appear on home screen!</em></p>
  </div>

  <div class="tab-bar">
    <div class="tab active" onclick="switchTab('status')">
      <div class="tab-icon">📸</div>
      <div>Status Saver</div>
    </div>
    <div class="tab" onclick="switchTab('business')">
      <div class="tab-icon">📱</div>
      <div>WhatsApp Business</div>
    </div>
    <div class="tab" onclick="switchTab('saved')">
      <div class="tab-icon">💾</div>
      <div>My Gallery</div>
    </div>
    <div class="tab" onclick="switchTab('help')">
      <div class="tab-icon">❓</div>
      <div>Help & Guide</div>
    </div>
    <div class="tab" onclick="switchTab('settings')">
      <div class="tab-icon">⚙️</div>
      <div>Settings</div>
    </div>
  </div>

  <!-- Status Saver Page -->
  <div id="status-page" class="page active">
    <div class="content-section">
      <h2>WhatsApp Status Saver</h2>
      <p>Easily download and save status updates from WhatsApp Messenger. Never lose important status updates again!</p>
      
      <div class="step-by-step">
        <h3>How to Save Statuses:</h3>
        <div class="step">
          <strong>Step 1:</strong> Open WhatsApp and view the status
        </div>
        <div class="step">
          <strong>Step 2:</strong> Return to Savify and select your app
        </div>
        <div class="step">
          <strong>Step 3:</strong> Tap "Select Statuses" and choose files
        </div>
        <div class="step">
          <strong>Step 4:</strong> Access saved statuses in Gallery tab
        </div>
      </div>
    </div>

    <div class="app-selector">
      <input type="radio" id="whatsapp" name="app" checked>
      <label for="whatsapp">WhatsApp Messenger</label>
    </div>

    <div style="text-align: center; margin: 25px 0;">
      <button class="btn" onclick="selectStatuses('whatsapp')">📁 Select Statuses</button>
    </div>

    <div class="content-section">
      <h3>Why Use Savify?</h3>
      <ul class="feature-list">
        <li>Save images and videos from WhatsApp statuses</li>
        <li>100% free with no limitations</li>
        <li>Works with both WhatsApp and WhatsApp Business</li>
        <li>All files stored locally on your device</li>
        <li>No internet required to view saved statuses</li>
        <li>Dark and light theme support</li>
      </ul>
    </div>
  </div>

  <!-- WhatsApp Business Page -->
  <div id="business-page" class="page">
    <div class="content-section">
      <h2>WhatsApp Business Status Saver</h2>
      <p>Download status updates from WhatsApp Business accounts. Perfect for saving business promotions and announcements.</p>
    </div>

    <div class="app-selector">
      <input type="radio" id="business" name="app">
      <label for="business">WhatsApp Business</label>
    </div>

    <div style="text-align: center; margin: 25px 0;">
      <button class="btn" onclick="selectStatuses('business')">📁 Select Business Statuses</button>
    </div>
  </div>

  <!-- Saved Gallery Page -->
  <div id="saved-page" class="page">
    <div style="text-align: center; margin-bottom: 20px;">
      <button class="btn" onclick="loadGallery()" style="background: #666;">🔄 Refresh Gallery</button>
    </div>
    
    <div class="content-section">
      <h2>My Saved Status Gallery</h2>
      <p>All your saved WhatsApp statuses are stored here. Everything is stored locally on your device.</p>
    </div>

    <div class="gallery" id="gallery">
      <div class="loading" id="galleryLoading">Loading your saved statuses...</div>
    </div>
    <p id="no-items" style="display: none; text-align: center;">
      No saved items yet. <br>
      <button class="btn" onclick="switchTab('status')" style="margin-top: 10px;">Start Saving Statuses</button>
    </p>
  </div>

  <!-- Help & Guide Page -->
  <div id="help-page" class="page">
    <div class="content-section">
      <h2>Savify Help & User Guide</h2>
      <p>Welcome to Savify! This guide will help you make the most of our WhatsApp status saving features.</p>
    </div>

    <div class="content-section">
      <h3>❓ Frequently Asked Questions</h3>
      <div class="step-by-step">
        <div class="step">
          <strong>Q: Is Savify free to use?</strong><br>
          A: Yes! Savify is completely free with no hidden costs.
        </div>
        <div class="step">
          <strong>Q: Are my saved statuses private?</strong><br>
          A: Absolutely! All your saved statuses are stored locally on your device.
        </div>
        <div class="step">
          <strong>Q: Does this work with video statuses?</strong><br>
          A: Yes! Savify supports both image and video status updates.
        </div>
      </div>
    </div>
  </div>

  <!-- Settings Page -->
  <div id="settings-page" class="page">
    <div class="vip-section" onclick="activateVIP()">
      <div class="vip-badge">⭐ VIP FEATURES</div>
      <h3>Remove All Ads</h3>
      <p>Enjoy Savify without any advertisements.</p>
    </div>

    <div class="content-section">
      <h3>App Preferences</h3>
      <div class="setting-item">
        <div>
          <h4>How to Use Guide</h4>
          <p>Step-by-step tutorial</p>
        </div>
        <div onclick="showGuide()" style="cursor: pointer;">📖</div>
      </div>

      <div class="setting-item">
        <div>
          <h4>Theme Selection</h4>
          <p>Switch between light and dark mode</p>
        </div>
        <label class="toggle" id="themeToggle" onclick="toggleTheme()">
          <div class="toggle-knob"></div>
        </label>
      </div>
    </div>

    <div class="content-section">
      <h3>Information</h3>
      <div class="setting-item">
        <div>
          <h4>Privacy Policy</h4>
          <p>How we protect your data</p>
        </div>
        <div onclick="showPrivacyPolicy()" style="cursor: pointer;">📄</div>
      </div>

      <div class="setting-item">
        <div>
          <h4>About Savify</h4>
          <p>Learn about our app</p>
        </div>
        <div onclick="showAboutUs()" style="cursor: pointer;">ℹ️</div>
      </div>
    </div>

    <div class="content-section">
      <h3>Data Management</h3>
      <div class="setting-item">
        <div>
          <h4>Clear All Saved Data</h4>
          <p>Delete all saved statuses</p>
        </div>
        <button class="btn" onclick="clearAllData()" style="background: #ff4444; padding: 8px 16px;">Clear</button>
      </div>
    </div>
  </div>

  <!-- Ad Container -->
  <div id="ad-container">
    <p style="margin: 0; font-size: 12px; color: var(--text-color);">Advertisement</p>
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6774980266966517"
     crossorigin="anonymous"></script>
    <ins class="adsbygoogle"
         style="display:block"
         data-ad-client="ca-pub-6774980266966517"
         data-ad-slot="4095577151"
         data-ad-format="auto"
         data-full-width-responsive="true"></ins>
    <script>
         (adsbygoogle = window.adsbygoogle || []).push({});
    </script>
  </div>

  <script>
    // Storage configuration
    const storage = localforage.createInstance({
      name: "SavifyApp",
      version: 1.0,
      storeName: "savify_storage",
      description: "Savify status storage"
    });

    // App initialization
    setTimeout(() => {
      document.getElementById('splash').classList.add('hidden');
      checkGuide();
      loadGallery();
      checkVIPStatus();
    }, 2000);

    // Guide system
    function checkGuide() {
      storage.getItem('guideShown').then(shown => {
        if (!shown) {
          document.getElementById('guideOverlay').style.display = 'flex';
        } else {
          document.getElementById('status-page').classList.add('active');
        }
      });
    }

    let currentStep = 1;
    function nextStep() {
      document.getElementById(`step${currentStep}`).classList.remove('active');
      currentStep++;
      if (currentStep <= 5) {
        document.getElementById(`step${currentStep}`).classList.add('active');
      }
    }

    function skipGuide() {
      storage.setItem('guideShown', true);
      document.getElementById('guideOverlay').style.display = 'none';
      switchTab('status');
    }

    function closeGuide() {
      storage.setItem('guideShown', true);
      document.getElementById('guideOverlay').style.display = 'none';
      switchTab('status');
    }

    function showGuide() {
      currentStep = 1;
      document.querySelectorAll('.guide-step').forEach(step => step.classList.remove('active'));
      document.getElementById('step1').classList.add('active');
      document.getElementById('guideOverlay').style.display = 'flex';
    }

    // Theme management
    let isDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
    document.body.setAttribute('data-theme', isDark ? 'dark' : 'light');
    document.getElementById('themeToggle').classList.toggle('active', isDark);

    function toggleTheme() {
      isDark = !isDark;
      document.body.setAttribute('data-theme', isDark ? 'dark' : 'light');
      document.getElementById('themeToggle').classList.toggle('active', isDark);
    }

    // Navigation
    function switchTab(tab) {
      document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
      document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
      document.getElementById(tab + '-page').classList.add('active');
      event.target.closest('.tab').classList.add('active');
      
      if (tab === 'saved') {
        loadGallery();
      }
    }

    function showNotification() {
      document.getElementById('notificationPopup').style.display = 'block';
    }

    function hideNotification() {
      document.getElementById('notificationPopup').style.display = 'none';
    }

    // File handling
    async function selectStatuses(app) {
      const input = document.createElement('input');
      input.type = 'file';
      input.accept = 'image/*,video/*';
      input.multiple = true;
      input.onchange = async e => {
        const files = Array.from(e.target.files);
        let savedCount = 0;
        
        for (const file of files) {
          try {
            const dataUrl = await new Promise((resolve, reject) => {
              const reader = new FileReader();
              reader.onload = e => resolve(e.target.result);
              reader.onerror = reject;
              reader.readAsDataURL(file);
            });
            
            const item = {
              name: file.name,
              type: file.type,
              source: app,
              data: dataUrl,
              timestamp: Date.now(),
            };
            
            const key = `saved_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;
            await storage.setItem(key, item);
            savedCount++;
            
          } catch (error) {
            console.error('Failed to save:', file.name, error);
          }
        }
        
        if (savedCount > 0) {
          alert(`✅ Successfully saved ${savedCount} item(s)!`);
          await loadGallery();
          switchTab('saved');
        }
      };
      input.click();
    }

    // Gallery management
    async function loadGallery() {
      const gallery = document.getElementById('gallery');
      const noItems = document.getElementById('no-items');
      const loading = document.getElementById('galleryLoading');
      
      gallery.innerHTML = '';
      if (loading) loading.style.display = 'block';
      if (noItems) noItems.style.display = 'none';

      try {
        const keys = await storage.keys();
        const savedKeys = keys.filter(key => key.startsWith('saved_'));
        
        if (savedKeys.length === 0) {
          if (loading) loading.style.display = 'none';
          if (noItems) noItems.style.display = 'block';
          return;
        }

        let hasItems = false;
        
        for (const key of savedKeys) {
          try {
            const item = await storage.getItem(key);
            if (item && item.data) {
              hasItems = true;
              
              const div = document.createElement('div');
              div.className = 'gallery-item';
              
              const img = document.createElement('img');
              img.src = item.data;
              img.alt = item.name;
              
              const deleteBtn = document.createElement('button');
              deleteBtn.className = 'delete-btn';
              deleteBtn.innerHTML = '×';
              deleteBtn.onclick = () => deleteItem(key);
              
              div.appendChild(img);
              div.appendChild(deleteBtn);
              gallery.appendChild(div);
            }
          } catch (error) {
            console.error('Error loading item:', key, error);
          }
        }
        
        if (loading) loading.style.display = 'none';
        if (noItems) noItems.style.display = hasItems ? 'none' : 'block';
        
      } catch (error) {
        console.error('Error loading gallery:', error);
        if (loading) loading.style.display = 'none';
        if (noItems) noItems.style.display = 'block';
      }
    }

    async function deleteItem(key) {
      if (confirm('Are you sure you want to delete this item?')) {
        await storage.removeItem(key);
        await loadGallery();
      }
    }

    async function clearAllData() {
      if (confirm("Are you sure you want to delete ALL saved statuses?")) {
        const keys = await storage.keys();
        let deletedCount = 0;
        
        for (const key of keys) {
          if (key.startsWith('saved_')) {
            await storage.removeItem(key);
            deletedCount++;
          }
        }
        
        await loadGallery();
        alert(`🗑️ Deleted ${deletedCount} items!`);
      }
    }

    // VIP system
    async function checkVIPStatus() {
      const isVIP = await storage.getItem('isVIP');
      const adContainer = document.getElementById('ad-container');
      if (adContainer) {
        adContainer.style.display = isVIP ? 'none' : 'block';
      }
    }

    async function activateVIP() {
      if (confirm("Go VIP to remove all ads?")) {
        await storage.setItem('isVIP', true);
        await checkVIPStatus();
        alert("🎉 Thank you for becoming a VIP! All ads have been removed.");
      }
    }

    // Information modals
    function showPrivacyPolicy() {
      const policy = `<h2>Privacy Policy</h2><p>Savify does not collect or share any personal data. All your data stays on your device.</p>`;
      const modal = document.createElement('div');
      modal.className = 'modal-overlay';
      modal.innerHTML = `<div class="modal-content"><button class="close-modal" onclick="this.parentElement.parentElement.remove()">×</button>${policy}</div>`;
      document.body.appendChild(modal);
    }

    function showAboutUs() {
      const about = `<h2>About Savify</h2><p>Savify helps you save WhatsApp status updates easily and securely.</p>`;
      const modal = document.createElement('div');
      modal.className = 'modal-overlay';
      modal.innerHTML = `<div class="modal-content"><button class="close-modal" onclick="this.parentElement.parentElement.remove()">×</button>${about}</div>`;
      document.body.appendChild(modal);
    }

    // App selection
    document.querySelectorAll('input[name="app"]').forEach(radio => {
      radio.addEventListener('change', e => {
        const app = e.target.id;
        if (app === 'whatsapp') switchTab('status');
        else switchTab('business');
      });
    });

    function shareApp() {
      alert('Share Savify with your friends!');
    }

    function rateApp() {
      alert('Please rate Savify in your app store!');
    }

    // PWA detection
    if (window.matchMedia('(display-mode: standalone)').matches) {
      console.log('Savify is running as installed app');
    }
  </script>
</body>
</html>
