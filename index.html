<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<!-- Google AdSense Verification -->
<meta name="google-adsense-account" content="ca-pub-6774980266966517">
<!-- LocalForage Storage Library -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/localforage/1.10.0/localforage.min.js"></script>
<title>Savify</title>
<style>
  :root {
    --bg-color: #f0f0f0;
    --text-color: #000;
    --topbar-bg: #25D366;
    --topbar-text: #fff;
    --tab-bg: #fff;
    --tab-text: #666;
    --active-tab: #25D366;
    --setting-bg: #fff;
    --toggle-bg: #ddd;
    --toggle-active: #25D366;
  }
  [data-theme="dark"] {
    --bg-color: #121212;
    --text-color: #fff;
    --topbar-bg: #075e54;
    --topbar-text: #fff;
    --tab-bg: #1e1e1e;
    --tab-text: #bbb;
    --active-tab: #25D366;
    --setting-bg: #1e1e1e;
    --toggle-bg: #444;
    --toggle-active: #25D366;
  }
  body {
    margin: 0;
    padding: 14px;
    font-family: Arial, sans-serif;
    background: var(--bg-color);
    color: var(--text-color);
    transition: all 0.3s;
  }
  .topbar {
    display: flex;
    align-items: center;
    justify-content: space-between;
    background: var(--topbar-bg);
    color: var(--topbar-text);
    padding: 10px;
    border-radius: 10px 10px 0 0;
  }
  .bell {
    font-size: 24px;
    cursor: pointer;
  }
  .notification-popup {
    display: none;
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background: var(--setting-bg);
    padding: 20px;
    border-radius: 10px;
    box-shadow: 0 0 10px rgba(0,0,0,0.1);
    z-index: 1000;
    text-align: center;
    color: var(--text-color);
  }
  .notification-popup img {
    max-width: 100%;
    height: auto;
  }
  .notification-popup .close {
    position: absolute;
    top: 10px;
    right: 10px;
    font-size: 20px;
    cursor: pointer;
    color: var(--text-color);
  }
  .tab-bar {
    display: flex;
    justify-content: space-around;
    background: var(--tab-bg);
    padding: 10px;
    border-bottom: 1px solid #eee;
  }
  .tab {
    display: flex;
    flex-direction: column;
    align-items: center;
    color: var(--tab-text);
    font-size: 12px;
  }
  .tab.active {
    color: var(--active-tab);
  }
  .tab-icon {
    width: 24px;
    height: 24px;
    margin-bottom: 4px;
    background: currentColor;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 12px;
  }
  .page {
    display: none;
    background: var(--setting-bg);
    padding: 20px;
    color: var(--text-color);
  }
  .page.active {
    display: block;
  }
  .splash {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: var(--bg-color);
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    z-index: 1000;
    opacity: 1;
    transition: opacity 0.5s ease;
  }
  .splash.hidden {
    opacity: 0;
    pointer-events: none;
  }
  .logo img {
    width: 100px;
    height: auto;
  }
  .name {
    font-size: 24px;
    font-weight: bold;
    color: var(--topbar-text);
    margin-top: 10px;
  }
  .homepage-empty {
    text-align: center;
    padding: 40px;
  }
  .homepage-empty p {
    color: var(--text-color);
  }
  .guide-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: var(--bg-color);
    z-index: 9999;
    display: none;
    justify-content: center;
    align-items: center;
    flex-direction: column;
    padding: 20px;
  }
  .guide-step {
    display: none;
    text-align: center;
  }
  .guide-step.active {
    display: block;
  }
  .guide-step img {
    width: 100%;
    max-width: 300px;
    margin-bottom: 20px;
  }
  .guide-step p {
    font-size: 16px;
    margin-bottom: 20px;
  }
  .guide-buttons {
    display: flex;
    gap: 10px;
  }
  .skip-btn {
    background: transparent;
    border: 1px solid var(--text-color);
    color: var(--text-color);
    padding: 10px 20px;
    border-radius: 25px;
    cursor: pointer;
  }
  .setting-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 15px 0;
    border-bottom: 1px solid #333;
  }
  .toggle {
    background: var(--toggle-bg);
    border-radius: 20px;
    width: 50px;
    height: 30px;
    position: relative;
  }
  .toggle.active {
    background: var(--toggle-active);
  }
  .toggle-knob {
    background: var(--topbar-text);
    border-radius: 50%;
    width: 26px;
    height: 26px;
    position: absolute;
    top: 2px;
    left: 2px;
    transition: transform 0.2s;
  }
  .toggle.active .toggle-knob {
    transform: translateX(20px);
  }
  .app-selector {
    display: flex;
    gap: 10px;
  }
  .app-selector input[type="radio"] {
    display: none;
  }
  .app-selector label {
    padding: 10px;
    background: #eee;
    border-radius: 5px;
    cursor: pointer;
    color: var(--text-color);
  }
  .app-selector input[type="radio"]:checked + label {
    background: var(--toggle-active);
    color: var(--topbar-text);
  }
  .btn {
    background: var(--topbar-bg);
    color: var(--topbar-text);
    border: none;
    padding: 10px 20px;
    border-radius: 25px;
    cursor: pointer;
  }
  .vip-section {
    background: var(--setting-bg);
    padding: 20px;
    margin-bottom: 20px;
    border-radius: 10px;
    text-align: center;
    color: var(--text-color);
    cursor: pointer;
  }
  .vip-badge {
    background: yellow;
    color: #000;
    padding: 5px 10px;
    border-radius: 20px;
    font-weight: bold;
    margin-bottom: 10px;
  }
  .gallery {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
    gap: 10px;
    padding: 20px 0;
  }
  .gallery-item {
    position: relative;
    overflow: hidden;
    border-radius: 10px;
  }
  .gallery-item img {
    width: 100%;
    height: auto;
    display: block;
  }
  .gallery-item .delete-btn {
    position: absolute;
    top: 5px;
    right: 5px;
    background: rgba(255, 0, 0, 0.7);
    color: white;
    border: none;
    border-radius: 50%;
    width: 25px;
    height: 25px;
    cursor: pointer;
    font-size: 16px;
  }
  #ad-container {
    padding: 10px;
    text-align: center;
    background: var(--setting-bg);
    border-top: 1px solid #eee;
    margin-top: 20px;
  }
  .modal-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0,0,0,0.8);
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 10000;
  }
  .modal-content {
    background: var(--setting-bg);
    padding: 20px;
    border-radius: 10px;
    max-width: 90%;
    max-height: 80%;
    overflow-y: auto;
    position: relative;
  }
  .close-modal {
    position: absolute;
    top: 10px;
    right: 10px;
    background: none;
    border: none;
    font-size: 24px;
    cursor: pointer;
    color: var(--text-color);
  }
  .loading {
    text-align: center;
    padding: 20px;
  }
</style>
</head>
<body>
  <div class="splash" id="splash">
    <div class="logo">
      <img src="icon.png" alt="Savify Logo">
    </div>
    <div class="name">Savify</div>
  </div>
  <div class="guide-overlay" id="guideOverlay">
    <div class="guide-step active" id="step1">
      <img src="step1.png" alt="Step 1: Open WhatsApp">
      <p>Step 1: Open WhatsApp or WhatsApp Business and view a status.</p>
      <div class="guide-buttons">
        <button class="skip-btn" onclick="skipGuide()">Skip All</button>
        <button class="btn" id="nextBtn" onclick="nextStep()">Next</button>
      </div>
    </div>
    <div class="guide-step" id="step2">
      <img src="step2.png" alt="Step 2: Switch to Savify">
      <p>Step 2: Switch to Savify and tap "Select Statuses".</p>
      <div class="guide-buttons">
        <button class="skip-btn" onclick="skipGuide()">Skip All</button>
        <button class="btn" id="nextBtn" onclick="nextStep()">Next</button>
      </div>
    </div>
    <div class="guide-step" id="step3">
      <img src="step3.png" alt="Step 3: Select Files">
      <p>Step 3: Navigate to the .Statuses folder and select images/videos.</p>
      <div class="guide-buttons">
        <button class="skip-btn" onclick="skipGuide()">Skip All</button>
        <button class="btn" id="nextBtn" onclick="nextStep()">Next</button>
      </div>
    </div>
    <div class="guide-step" id="step4">
      <img src="step4.png" alt="Step 4: Check Saved">
      <p>Step 4: Check the Saved tab to view your gallery.</p>
      <div class="guide-buttons">
        <button class="skip-btn" onclick="skipGuide()">Skip All</button>
        <button class="btn" id="nextBtn" onclick="nextStep()">Next</button>
      </div>
    </div>
    <div class="guide-step" id="step5">
      <img src="step5.png" alt="Step 5: Settings">
      <p>Step 5: Use Settings to enable notifications or auto-save.</p>
      <div class="guide-buttons">
        <button class="skip-btn" onclick="skipGuide()">Skip All</button>
        <button class="btn" id="nextBtn" onclick="closeGuide()">Finish</button>
      </div>
    </div>
  </div>
  <div class="topbar">
    <h1>Savify</h1>
    <div class="bell" onclick="showNotification()">üîî</div>
  </div>
  <div class="notification-popup" id="notificationPopup">
    <span class="close" onclick="hideNotification()">√ó</span>
    <img src="notification.png" alt="New Status Notification">
    <p>Get notified when new statuses available</p>
    <button class="btn" onclick="hideNotification()">CONTINUE</button>
  </div>
  <div class="tab-bar">
    <div class="tab active" onclick="switchTab('status')">
      <div class="tab-icon">üì∏</div>
      <div>Status</div>
    </div>
    <div class="tab" onclick="switchTab('business')">
      <div class="tab-icon">üì±</div>
      <div>WhatsApp Business</div>
    </div>
    <div class="tab" onclick="switchTab('saved')">
      <div class="tab-icon">üíæ</div>
      <div>Saved</div>
    </div>
    <div class="tab" onclick="switchTab('settings')">
      <div class="tab-icon">‚öôÔ∏è</div>
      <div>Settings</div>
    </div>
  </div>
  <div id="status-page" class="page">
    <div class="homepage-empty">
      <p>No images or videos available now.</p>
      <ul>
        <li>Open the Status tab</li>
        <li>Watch the full status</li>
        <li>Open Savify to save</li>
      </ul>
      <button class="btn" onclick="openWhatsApp('whatsapp')">Open WhatsApp</button>
      <div style="margin-top: 20px;">
        <input type="radio" id="whatsapp" name="app" checked>
        <label for="whatsapp">WhatsApp Messenger</label>
      </div>
      <button class="btn" onclick="selectStatuses('whatsapp')">Select Statuses</button>
      <p style="font-size: 12px; color: var(--text-color);">Tip: Navigate to /Android/media/com.whatsapp/WhatsApp/Media/.Statuses/ for images and videos.</p>
    </div>
  </div>
  <div id="business-page" class="page">
    <div class="homepage-empty">
      <p>No images or videos available now.</p>
      <ul>
        <li>Open the WhatsApp Business tab</li>
        <li>Watch the full status</li>
        <li>Open Savify to save</li>
      </ul>
      <button class="btn" onclick="openWhatsApp('business')">Open WhatsApp Business</button>
      <div style="margin-top: 20px;">
        <input type="radio" id="business" name="app">
        <label for="business">WhatsApp Business</label>
      </div>
      <button class="btn" onclick="selectStatuses('business')">Select Statuses</button>
      <p style="font-size: 12px; color: var(--text-color);">Tip: Navigate to /Android/media/com.whatsapp.w4b/WhatsApp Business/Media/.Statuses/ for images and videos.</p>
    </div>
  </div>
  <div id="saved-page" class="page">
    <div style="text-align: center; margin-bottom: 10px;">
      <button class="btn" onclick="loadGallery()" style="background: #666;">Refresh Gallery</button>
    </div>
    <div class="gallery" id="gallery">
      <div class="loading" id="galleryLoading">Loading your saved statuses...</div>
    </div>
    <p id="no-items" style="display: none; text-align: center;">No saved items yet.</p>
  </div>
  <div id="settings-page" class="page">
    <div class="vip-section" onclick="activateVIP()">
      <div class="vip-badge">VIP</div>
      <div>Remove All Ads</div>
      <div>Enjoy Savify without Ads</div>
    </div>
    <div class="setting-item">
      <div>
        <h3>How to use</h3>
        <p>Know how to use this app to download statuses</p>
      </div>
      <div onclick="showGuide()">‚Üí</div>
    </div>
    <div class="setting-item">
      <div>
        <h3>Notification New Status</h3>
        <p>Get notified when new statuses available</p>
      </div>
      <label class="toggle" onclick="toggleSetting(this)">
        <div class="toggle-knob"></div>
      </label>
    </div>
    <div class="setting-item">
      <div>
        <h3>Auto Save</h3>
        <p>Automatically Save all New Statuses</p>
      </div>
      <label class="toggle" onclick="toggleSetting(this)">
        <div class="toggle-knob"></div>
      </label>
    </div>
    <div class="setting-item">
      <div>
        <h3>Save Statuses in Folder</h3>
        <p>/storage/emulated/0/Download/Savify</p>
      </div>
      <div onclick="alert('Folder settings opens here!')">‚Üí</div>
    </div>
    <div class="setting-item">
      <div>
        <h3>Privacy Policy</h3>
        <p>How we handle your data and privacy</p>
      </div>
      <div onclick="showPrivacyPolicy()">‚Üí</div>
    </div>
    <div class="setting-item">
      <div>
        <h3>About Us</h3>
        <p>Learn more about Savify app</p>
      </div>
      <div onclick="showAboutUs()">‚Üí</div>
    </div>
    <div class="setting-item">
      <div>
        <h3>Clear All Data</h3>
        <p>Delete all saved statuses and reset app</p>
      </div>
      <button class="btn" onclick="clearAllData()" style="background: #ff4444;">Clear</button>
    </div>
    <div class="setting-item">
      <div>
        <h3>Share with others</h3>
        <p>Share this app with your beloved friends</p>
      </div>
      <button class="btn" onclick="shareApp()">Share</button>
    </div>
    <div class="setting-item">
      <div>
        <h3>Rate us</h3>
        <p>Please support our work by your rating</p>
      </div>
      <button class="btn" onclick="rateApp()">Rate</button>
    </div>
    <div class="setting-item">
      <div>
        <h3>Theme</h3>
        <p>Switch between light and dark</p>
      </div>
      <label class="toggle" id="themeToggle" onclick="toggleTheme()">
        <div class="toggle-knob"></div>
      </label>
    </div>
  </div>

  <!-- Ad Container with REAL AD CODE -->
  <div id="ad-container">
    <p style="margin: 0; font-size: 12px; color: var(--text-color);">Advertisement</p>
    <!-- YOUR REAL AD CODE -->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6774980266966517"
     crossorigin="anonymous"></script>
    <!-- Savify Banner Ad -->
    <ins class="adsbygoogle"
         style="display:block"
         data-ad-client="ca-pub-6774980266966517"
         data-ad-slot="4095577151"
         data-ad-format="auto"
         data-full-width-responsive="true"></ins>
    <script>
         (adsbygoogle = window.adsbygoogle || []).push({});
    </script>
  </div>

  <script>
    // Configure localForage for reliable storage
    const storage = localforage.createInstance({
      name: "SavifyApp",
      version: 1.0,
      storeName: "savify_storage",
      description: "Savify status storage"
    });

    // Splash screen fade
    setTimeout(() => {
      document.getElementById('splash').classList.add('hidden');
      checkGuide();
      loadGallery();
      checkVIPStatus();
    }, 2000);

    // Guide page logic
    function checkGuide() {
      storage.getItem('guideShown').then(shown => {
        if (!shown) {
          document.getElementById('guideOverlay').style.display = 'flex';
        } else {
          document.getElementById('status-page').classList.add('active');
        }
      });
    }

    let currentStep = 1;
    function nextStep() {
      document.getElementById(`step${currentStep}`).classList.remove('active');
      currentStep++;
      document.getElementById(`step${currentStep}`).classList.add('active');
      if (currentStep === 5) {
        document.getElementById('nextBtn').innerText = 'Finish';
      }
    }

    function skipGuide() {
      storage.setItem('guideShown', true);
      document.getElementById('guideOverlay').style.display = 'none';
      document.getElementById('status-page').classList.add('active');
    }

    function closeGuide() {
      storage.setItem('guideShown', true);
      document.getElementById('guideOverlay').style.display = 'none';
      document.getElementById('status-page').classList.add('active');
    }

    function showGuide() {
      currentStep = 1;
      document.querySelectorAll('.guide-step').forEach(step => step.classList.remove('active'));
      document.getElementById('step1').classList.add('active');
      document.getElementById('guideOverlay').style.display = 'flex';
    }

    // Auto-detect phone theme and initialize toggle
    let isDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
    document.body.setAttribute('data-theme', isDark ? 'dark' : 'light');
    document.getElementById('themeToggle').classList.toggle('active', isDark);

    window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', e => {
      isDark = e.matches;
      document.body.setAttribute('data-theme', isDark ? 'dark' : 'light');
      document.getElementById('themeToggle').classList.toggle('active', isDark);
    });

    function toggleTheme() {
      isDark = !isDark;
      document.body.setAttribute('data-theme', isDark ? 'dark' : 'light');
      document.getElementById('themeToggle').classList.toggle('active', isDark);
    }

    function switchTab(tab) {
      document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
      document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
      document.getElementById(tab + '-page').classList.add('active');
      event.target.closest('.tab').classList.add('active');
      
      // RELOAD GALLERY WHEN SWITCHING TO SAVED TAB
      if (tab === 'saved') {
        loadGallery();
      }
    }

    function toggleSetting(el) {
      el.classList.toggle('active');
    }

    function showNotification() {
      document.getElementById('notificationPopup').style.display = 'block';
    }

    function hideNotification() {
      document.getElementById('notificationPopup').style.display = 'none';
    }

    function openWhatsApp(app) {
      if (app === 'whatsapp') {
        alert('Please open WhatsApp manually to view statuses, then return to Savify to save them.');
      } else {
        alert('Please open WhatsApp Business manually to view statuses, then return to Savify to save them.');
      }
    }

    // FIXED: This function now properly saves images to storage
    async function selectStatuses(app) {
      const input = document.createElement('input');
      input.type = 'file';
      input.accept = 'image/*,video/*';
      input.multiple = true;
      input.onchange = async e => {
        const files = Array.from(e.target.files);
        let savedCount = 0;
        
        // Process each file and wait for it to complete
        for (const file of files) {
          try {
            const dataUrl = await new Promise((resolve, reject) => {
              const reader = new FileReader();
              reader.onload = e => resolve(e.target.result);
              reader.onerror = reject;
              reader.readAsDataURL(file);
            });
            
            const item = {
              name: file.name,
              type: file.type,
              source: app,
              data: dataUrl,
              timestamp: Date.now(),
              size: file.size
            };
            
            // Create unique key and save to storage
            const key = `saved_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;
            await storage.setItem(key, item);
            savedCount++;
            console.log('‚úÖ Saved:', file.name, 'as', key);
            
          } catch (error) {
            console.error('‚ùå Failed to save:', file.name, error);
          }
        }
        
        // Show success message and refresh gallery
        if (savedCount > 0) {
          alert(`Successfully saved ${savedCount} item(s)!`);
          await loadGallery();
          switchTab('saved');
        } else {
          alert('Failed to save any items. Please try again.');
        }
      };
      input.click();
    }

    // FIXED: This function properly loads images from storage
    async function loadGallery() {
      const gallery = document.getElementById('gallery');
      const noItems = document.getElementById('no-items');
      const loading = document.getElementById('galleryLoading');
      
      gallery.innerHTML = '';
      if (loading) loading.style.display = 'block';
      if (noItems) noItems.style.display = 'none';

      try {
        const keys = await storage.keys();
        const savedKeys = keys.filter(key => key.startsWith('saved_'));
        
        console.log('üîç Loading gallery, found items:', savedKeys.length);
        
        if (savedKeys.length === 0) {
          if (loading) loading.style.display = 'none';
          if (noItems) noItems.style.display = 'block';
          return;
        }

        let hasItems = false;
        
        for (const key of savedKeys) {
          try {
            const item = await storage.getItem(key);
            if (item && item.data) {
              hasItems = true;
              
              const div = document.createElement('div');
              div.className = 'gallery-item';
              
              const img = document.createElement('img');
              img.src = item.data;
              img.alt = item.name;
              img.style.cssText = 'width: 100%; height: 100px; object-fit: cover;';
              
              const deleteBtn = document.createElement('button');
              deleteBtn.className = 'delete-btn';
              deleteBtn.innerHTML = '√ó';
              deleteBtn.onclick = () => deleteItem(key);
              
              div.appendChild(img);
              div.appendChild(deleteBtn);
              gallery.appendChild(div);
            }
          } catch (error) {
            console.error('Error loading item:', key, error);
          }
        }
        
        if (loading) loading.style.display = 'none';
        if (noItems) noItems.style.display = hasItems ? 'none' : 'block';
        
        console.log('‚úÖ Gallery loaded successfully. Items:', hasItems);
        
      } catch (error) {
        console.error('‚ùå Error loading gallery:', error);
        if (loading) loading.style.display = 'none';
        if (noItems) noItems.style.display = 'block';
      }
    }

    async function deleteItem(key) {
      if (confirm('Are you sure you want to delete this item?')) {
        await storage.removeItem(key);
        await loadGallery();
      }
    }

    async function checkVIPStatus() {
      const isVIP = await storage.getItem('isVIP');
      const adContainer = document.getElementById('ad-container');
      if(adContainer) {
        adContainer.style.display = isVIP ? 'none' : 'block';
      }
    }

    async function activateVIP() {
      if(confirm("Go VIP to remove all ads? (This is a demo. In a real app, a payment screen would appear here.)")) {
        await storage.setItem('isVIP', true);
        await checkVIPStatus();
        alert("Thank you for becoming a VIP! Ads have been removed.");
      }
    }

    async function clearAllData() {
      if(confirm("Are you sure you want to delete ALL saved statuses? This cannot be undone.")) {
        const keys = await storage.keys();
        let deletedCount = 0;
        
        for (const key of keys) {
          if (key.startsWith('saved_')) {
            await storage.removeItem(key);
            deletedCount++;
          }
        }
        
        await loadGallery();
        alert(`Deleted ${deletedCount} items!`);
      }
    }

    function showPrivacyPolicy() {
      const policy = `
        <h2>Privacy Policy</h2>
        
        <h3>Data Collection</h3>
        <p>Savify does not collect, store, or share any personal information. All data remains on your device using secure local storage.</p>
        
        <h3>Local Storage</h3>
        <p>We use localForage library to securely store your saved statuses locally on your device. No data is sent to any server.</p>
        
        <h3>Third-Party Services</h3>
        <p>We use Google AdSense to display ads. AdSense may use cookies to serve personalized ads based on your browsing history.</p>
        
        <h3>Permissions</h3>
        <p>Savify requires file access only to save statuses you choose to download. We cannot access any other files on your device.</p>
        
        <h3>Contact</h3>
        <p>For privacy concerns: contact@savify.app</p>
        
        <p><em>Last updated: ${new Date().toLocaleDateString()}</em></p>
      `;
      
      const modal = document.createElement('div');
      modal.className = 'modal-overlay';
      modal.innerHTML = `
        <div class="modal-content">
          <button class="close-modal" onclick="this.parentElement.parentElement.remove()">√ó</button>
          <div style="text-align: left; max-width: 500px;">
            ${policy}
          </div>
        </div>
      `;
      document.body.appendChild(modal);
    }

    function showAboutUs() {
      const about = `
        <h2>About Savify</h2>
        
        <p><strong>Save WhatsApp Statuses Easily</strong></p>
        
        <p>Savify helps you download and save status updates from WhatsApp and WhatsApp Business with just a few taps.</p>
        
        <h3>Features:</h3>
        <ul style="text-align: left;">
          <li>Save images and videos from statuses</li>
          <li>Support for WhatsApp & WhatsApp Business</li>
          <li>Organize saved statuses in gallery</li>
          <li>Dark/Light theme support</li>
          <li>Secure local storage with localForage</li>
          <li>100% free with optional ad removal</li>
        </ul>
        
        <h3>How It Works:</h3>
        <p>1. View status in WhatsApp<br>
           2. Use Savify to access status files<br>
           3. Save to your gallery<br>
           4. Enjoy offline access!</p>
        
        <p><strong>No data collection ‚Ä¢ No server storage ‚Ä¢ Everything stays on your device</strong></p>
        
        <p>Version 2.0<br>
        Built with ‚ù§Ô∏è for WhatsApp users</p>
      `;
      
      const modal = document.createElement('div');
      modal.className = 'modal-overlay';
      modal.innerHTML = `
        <div class="modal-content">
          <button class="close-modal" onclick="this.parentElement.parentElement.remove()">√ó</button>
          <div style="text-align: center; max-width: 500px;">
            ${about}
          </div>
        </div>
      `;
      document.body.appendChild(modal);
    }

    document.querySelectorAll('input[name="app"]').forEach(radio => {
      radio.addEventListener('change', e => {
        const app = e.target.id;
        if (app === 'whatsapp') switchTab('status');
        else switchTab('business');
      });
    });

    function shareApp() {
      if (navigator.share) {
        navigator.share({ title: 'Savify', text: 'Download statuses from WhatsApp & Business!' });
      } else {
        alert('Share dialog opens here!');
      }
    }

    function rateApp() {
      alert('Rate dialog opens here!');
    }

    // Debug function to check storage
    async function debugStorage() {
      const keys = await storage.keys();
      const savedItems = keys.filter(key => key.startsWith('saved_'));
      console.log('üìä STORAGE STATUS:', savedItems.length, 'saved items');
      return savedItems.length;
    }

    // Auto-check storage on load
    setTimeout(debugStorage, 3000);
  </script>
</body>
</html>
